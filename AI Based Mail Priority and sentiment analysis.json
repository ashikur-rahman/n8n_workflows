{
  "name": "AI Based Mail Priority and sentiment analysis",
  "nodes": [
    {
      "parameters": {
        "options": {
          "systemMessage": "=You are an AI assistant designed to read incoming emails from a Gmail account, \nanalyze their content, determine the Sentiment, and assess their Priority.\n\n\n##AGENT INSTRUCTIONS\n\nPerform the following tasks: \n\n1.Access the Gmail account securely and retrieve the latest unread emails.\n\n2.For each email, extract the subject line and body text.\n\n3.Analyze the content of the email to determine the primary topic or theme.Use natural language processing techniques to identify keywords and phrases related to the main subject.\n\n4.Perform sentiment analysis on the email's content, categorizing the sentiment as positive, negative, or neutral.Provide a confidence score for the sentiment classification.\n\n5.Assess the importance of the email based on the following criteria: - Relevance to ongoing projects or tasks.- Presence of actionable items or requests.- Urgency indicated by the sender or subject line.- Historical importance based on previous interactions with the sender.\n\n6.Compile the results into a structured format suitable for Google Sheets, including the following columns: - Email Sender - Subject Line - Main Topic - Sentiment (Positive, Negative, Neutral) - Sentiment Confidence Score - Priority Level (High, Medium, Low) \n\n7.Automatically append this structured data to a designated Google Sheet for easy tracking and analysis.Ensure that the process is efficient, handles multiple emails in one run, and maintains user privacy and data security throughout.\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.2,
      "position": [
        208,
        0
      ],
      "id": "8dfbae3c-c90b-4ea2-bf15-37f30150ca94",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        -48,
        208
      ],
      "id": "d64df315-29ee-4079-b165-b6aa80b17a5a",
      "name": "OpenAI Chat Model",
      "credentials": {
        "openAiApi": {
          "id": "OwQTTA9S2I5Ot4em",
          "name": "OpenAi account 2"
        }
      }
    },
    {
      "parameters": {
        "operation": "getAll",
        "limit": 5,
        "filters": {}
      },
      "type": "n8n-nodes-base.gmailTool",
      "typeVersion": 2.1,
      "position": [
        288,
        208
      ],
      "id": "2d94322b-02b3-445b-832b-44a3f45bc310",
      "name": "Get many messages in Gmail",
      "webhookId": "79a08135-5c56-49a8-b0ca-3daac5305304",
      "credentials": {
        "gmailOAuth2": {
          "id": "gGH88US9GQDfSxbY",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "typeVersion": 1.3,
      "position": [
        -32,
        0
      ],
      "id": "e1e478c1-4b84-482b-8abc-0a901a46a890",
      "name": "When chat message received",
      "webhookId": "64dadfa6-72b3-4c44-91b3-f89be5e8c643"
    },
    {
      "parameters": {},
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        112,
        208
      ],
      "id": "1267b9c0-3569-4d45-9bfb-bc19114ed940",
      "name": "Simple Memory"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1TXbohYoD5OTofuKpLn9mwYhc2OGvW4ich6K-IOrzBbs",
          "mode": "list",
          "cachedResultName": "Email Sentimanet Analysis",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1TXbohYoD5OTofuKpLn9mwYhc2OGvW4ich6K-IOrzBbs/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Sheet1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1TXbohYoD5OTofuKpLn9mwYhc2OGvW4ich6K-IOrzBbs/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "From": "={{ $fromAI(\"From\",\"This is the From email\") }}",
            "Message": "={{ $fromAI(\"Message\",\"This is the Message body of the email\") }}",
            "Sentiment": "={{ $fromAI(\"Sentiment\",\"This is the Sentiment of the  email\") }}",
            "Priority": "={{ $fromAI(\"Priority\",\"This is the Priority email\") }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "From",
              "displayName": "From",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Message",
              "displayName": "Message",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Sentiment",
              "displayName": "Sentiment",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Priority",
              "displayName": "Priority",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheetsTool",
      "typeVersion": 4.7,
      "position": [
        480,
        208
      ],
      "id": "c8822ceb-93fa-4eca-8245-fb2b257b1144",
      "name": "Append row in sheet in Google Sheets",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "etkFZ8S5lv2lHUNi",
          "name": "Google Sheets oAuth account"
        }
      }
    }
  ],
  "pinData": {},
  "connections": {
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Get many messages in Gmail": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "When chat message received": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Simple Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "Append row in sheet in Google Sheets": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "79ceade3-3f4d-4f5c-aa64-bace4a94779a",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "a67cde0d699ed1906995806d730af96a0aeb25342f36e93cbb36c8183e9c997f"
  },
  "id": "VuBstix4Y07t2Y0F",
  "tags": [
    {
      "createdAt": "2025-10-18T18:38:56.569Z",
      "updatedAt": "2025-10-18T18:38:56.569Z",
      "id": "8eJ0mX8AWWZMYl9z",
      "name": "AI Agent"
    },
    {
      "createdAt": "2025-10-19T10:32:35.500Z",
      "updatedAt": "2025-10-19T10:32:35.500Z",
      "id": "QIOvIGcGpzNYrmfq",
      "name": "filter"
    },
    {
      "createdAt": "2025-10-18T18:39:07.781Z",
      "updatedAt": "2025-10-18T18:39:07.781Z",
      "id": "gocsCMBj4lPPcPDp",
      "name": "Google Sheet"
    }
  ]
}